!function(d){function e(e){var t=d(e.target),r=t.closest(".crown-framework-field.group-set.field-table"),n=d("input[type=hidden]",t).filter(function(e,t){return void 0!==d(t).attr("name")&&d(t).attr("name").match(/\[new_entry_\d+\]\[crown_repeater_entry_id\]$/)}).first();t.data("crown-framework-field-table-column-title","");var a=d(),l=n.data("tpl-name").replace(/(\[?[^\]]+_)columns(\]?\[{{index}}\])/,"$1rows$2");l=l.replace(/\[new_entry_\d+\]/,"[{{index}}]");var i=d(".entry.tpl input[type=hidden]",r).filter(function(e,t){return d(t).data("tpl-name")==l}).first().closest(".field-repeater-entries");d("> .entry:not(.tpl)",i).each(function(e,t){var r=d(t),n=d("> .entry-fields > .crown-framework-field.repeater.field-table-cells",r);d("> .input-wrap > .field-repeater-entries",n).one("repeaterEntryAdded","> .entry",function(e){var t=d(e.target);d("> .entry-fields > fieldset.crown-framework-field.group > legend",t).text(""),a=d.merge(a,t)}),d("> .input-wrap > button.add-field-repeater-entry",n).trigger("click")}),t.data("crown-framework-field-table-column-cell-entries",a)}function t(e){d(e.target).data("crown-framework-field-table-column-cell-entries").remove()}function r(e){var t=d(e.target),r=t.closest(".entry"),n=t.val();r.data("crown-framework-field-table-column-title",n),r.data("crown-framework-field-table-column-cell-entries").each(function(e,t){var r=d(t);d("> .entry-fields > fieldset.crown-framework-field.group > legend",r).text(n)})}function n(e,t){d("> .entry:not(.tpl)",e.target).each(function(e,t){d(t).data("crown-framework-field-table-column-cell-entries").each(function(e,t){var r=d(t),n=r.closest(".field-repeater-entries");n.append(r),n.sortable("refreshPositions")})})}function a(e){var t=d(e.target),r=t.closest(".crown-framework-field.group-set.field-table"),l=d("> .entry-fields > .crown-framework-field.repeater.field-table-cells",t),n=d("input[type=hidden]",t).filter(function(e,t){return void 0!==d(t).attr("name")&&d(t).attr("name").match(/\[new_entry_\d+\]\[crown_repeater_entry_id\]$/)}).first().data("tpl-name").replace(/(\[?[^\]]+_)rows(\]?\[{{index}}\])/,"$1columns$2");n=n.replace(/\[new_entry_\d+\]/,"[{{index}}]");var a=d(".entry.tpl input[type=hidden]",r).filter(function(e,t){return d(t).data("tpl-name")==n}).first().closest(".field-repeater-entries");d("> .entry:not(.tpl)",a).each(function(e,t){var r=d(t),n=r.data("crown-framework-field-table-column-title"),a=r.data("crown-framework-field-table-column-cell-entries");d("> .input-wrap > .field-repeater-entries",l).one("repeaterEntryAdded","> .entry",function(e){var t=d(e.target);d("> .entry-fields > fieldset.crown-framework-field.group > legend",t).text(n),a=d.merge(a,t)}),d("> .input-wrap > button.add-field-repeater-entry",l).trigger("click"),r.data("crown-framework-field-table-column-cell-entries",a)})}d(document).ready(function(){d(document).on("repeaterEntryAdded",".crown-framework-field.repeater.field-table-columns > .input-wrap > .field-repeater-entries > .entry",e),d(document).on("repeaterEntryRemove",".crown-framework-field.repeater.field-table-columns > .input-wrap > .field-repeater-entries > .entry",t),d(document).on("keyup",".crown-framework-field.repeater.field-table-columns input.field-table-column-title-input",r),d(document).on("sortupdate",".crown-framework-field.repeater.field-table-columns > .input-wrap > .field-repeater-entries",n),d(document).on("repeaterEntryAdded",".crown-framework-field.repeater.field-table-rows > .input-wrap > .field-repeater-entries > .entry",a),d(".crown-framework-field.repeater.field-table-columns > .input-wrap > .field-repeater-entries").each(function(e,t){var r=d(t),n=r.closest(".crown-framework-field.group-set.field-table"),a=d("> .entry.tpl",r).first(),l=d("input[type=hidden]",a).filter(function(e,t){return d(t).data("tpl-name").match(/_columns\]?\[{{index}}\]\[crown_repeater_entry_id\]$/)}).first().data("tpl-name").replace(/(\[?[^\]]+_)columns(\]?\[{{index}}\])/,"$1rows$2"),o=d(".entry.tpl input[type=hidden]",n).filter(function(e,t){return d(t).data("tpl-name")==l}).first().closest(".field-repeater-entries");d("> .entry:not(.tpl)",r).each(function(a,e){var t=d(e),l=d("input[type=hidden]",t).filter(function(e,t){return void 0!==d(t).attr("name")&&d(t).attr("name").match(/\[entry_\d+\]\[crown_repeater_entry_id\]$/)}).first().next().find("> .input-wrap > input").val();t.data("crown-framework-field-table-column-title",l);var i=d();d("> .entry:not(.tpl)",o).each(function(e,t){var r=d(t),n=d("> .entry-fields > .crown-framework-field.repeater.field-table-cells > .input-wrap > .field-repeater-entries > .entry:not(.tpl)",r).eq(a);d("> .entry-fields > fieldset.crown-framework-field.group > legend",n).text(l),i=d.merge(i,n)}),t.data("crown-framework-field-table-column-cell-entries",i)})})})}(jQuery);