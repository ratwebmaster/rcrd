!function(s){var t;function u(){s(".crown-framework-field.conditional-ui, .postbox.conditional-ui").each(function(t,e){var a=s(e).data("conditional-ui-rules");for(var i in a)if(!a[i].passed)return s(e).removeClass("conditional-ui-active"),!0;s(e).addClass("conditional-ui-active")}),s(".crown-framework-field.group.conditional-ui").each(function(t,e){if(s(e).parent().hasClass("group-set-field-group")){var a=s(e).parent(),i=a.closest(".group-set-wrap").find("> .group-set-nav > li:eq("+a.index()+")");s(e).hasClass("conditional-ui-active")?(a.removeClass("disabled"),i.removeClass("disabled")):(a.addClass("disabled"),i.addClass("disabled"),i.hasClass("active")&&i.next().find("> a").trigger("click"))}})}function e(){s(".conditional-ui-property-input").not(".conditional-ui-property-input-initialized").each(function(t,e){s(e).closest(".entry.tpl").length||(function(i){var t=i.data("conditional-ui-rules");for(var n in t)if("input"==t[n].property){for(var e=t[n].options.inputName,a=i.closest(".entry-fields"),r=[];a.length&&!r.length;)r=o(e,a),a=a.parent().closest(".entry-fields");r.length||(r=o(e,s("body"))),r.each(function(t,e){var a=s(e).data("conditional-ui-target-elements");void 0===a&&(a=[]),a.push({element:i,ruleIndex:n}),s(e).data("conditional-ui-target-elements",a)}),r.on("change",c).trigger("change")}}(s(e)),s(e).addClass("conditional-ui-property-input-initialized"))})}function o(a,t){var e=s("input, textarea, select",t).filter(function(t,e){return void 0!==s(e).attr("name")&&s(e).attr("name").replace(/\[\]$/,"").replace(/^.+\[/g,"").replace(/\]$/,"").trim()==a.trim()});if(1<e.length){var i=null,n=!0;e.each(function(t,e){var a=void 0!==s(e).attr("type")?s(e).attr("type").trim():"text";if("checkbox"!=a&&"radio"!=a&&(n=!1),null===i&&(i=s(e).attr("name").trim()),s(e).attr("name").trim()!=i&&(n=!1),!n)return!1}),n||(e=s())}return e}function c(t){var a=s(t.target),n=a.val();if("checkbox"==a.attr("type")||"radio"==a.attr("type")){var e=s("input[type="+a.attr("type")+"]").filter(function(t,e){return s(e).attr("name")==a.attr("name")});"radio"==a.attr("type")?n=e.filter(":checked").length?e.filter(":checked").first().val():null:(n=[],e.filter(":checked").each(function(t,e){n.push(s(e).val())}))}Array.isArray(n)||(n=[n]);var r=a.data("conditional-ui-target-elements");for(i in r){var o=s(r[i].element).data("conditional-ui-rules")[r[i].ruleIndex],c=o.value.map(function(t){return String(t)}),l=s(n).filter(c);"!="==o.compare.toLowerCase()||"not in"==o.compare.toLowerCase()?o.passed=!l.length:o.passed=l.length}u()}s(document).ready(function(){s("#parent_id").on("change",function(t){var n=parseInt(s("option:selected",this).val());s(".conditional-ui-property-postParent").each(function(t,e){var a=s(e).data("conditional-ui-rules");for(var i in a)if("postParent"==a[i].property)switch(a[i].compare.toLowerCase()){case"!=":case"not in":a[i].passed=s.inArray(n,a[i].value)<0;break;default:a[i].passed=0<=s.inArray(n,a[i].value)}s(e).data("conditional-ui-rules",a)}),u()}),s("#post-formats-select input.post-format").on("change",function(t){var n=s("#post-formats-select input.post-format:checked").val();s(".conditional-ui-property-postFormat").each(function(t,e){var a=s(e).data("conditional-ui-rules");for(var i in a)if("postFormat"==a[i].property)switch(a[i].compare.toLowerCase()){case"!=":case"not in":a[i].passed=s.inArray(n,a[i].value)<0;break;default:a[i].passed=0<=s.inArray(n,a[i].value)}s(e).data("conditional-ui-rules",a)}),u()}),s(".categorydiv .categorychecklist").on("change","input[type=checkbox]",function(t){var e=s(this).closest("ul.categorychecklist"),r=e.attr("id").replace(/checklist(-pop)?$/,""),o=[];s("li input[type=checkbox]:checked",e).each(function(t,e){o.push(parseInt(s(e).val()))}),s(".conditional-ui-property-taxonomyTerm").each(function(t,e){var a=s(e).data("conditional-ui-rules");for(var i in a)if("taxonomyTerm"==a[i].property&&a[i].options.taxonomy==r){var n=s(a[i].value).filter(o);switch(a[i].compare.toLowerCase()){case"!=":case"not in":a[i].passed=!n.length;break;default:a[i].passed=n.length}}s(e).data("conditional-ui-rules",a)}),u()}),s("#page_template").on("change",function(t){var n=s("option:selected",this).val();s(".conditional-ui-property-pageTemplate").each(function(t,e){var a=s(e).data("conditional-ui-rules");for(var i in a)if("pageTemplate"==a[i].property)switch(a[i].compare.toLowerCase()){case"!=":case"not in":a[i].passed=s.inArray(n,a[i].value)<0;break;default:a[i].passed=0<=s.inArray(n,a[i].value)}s(e).data("conditional-ui-rules",a)}),u()}),e(),s(".postbox.conditional-ui").each(function(t,e){var a=s(e).attr("id");s('#adv-settings .metabox-prefs label[for="'+a+'-hide"]').hide()}),u(),s(document).on("repeaterEntryAdded",e)}),s.crownUIRule=((t={}).initMetaBox=function(t,e){s("#"+t).data("conditional-ui-rules",e)},t)}(jQuery);